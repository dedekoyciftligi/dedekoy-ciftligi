<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DedekÃ¶y Ã‡iftliÄŸi</title>
<script src="https://unpkg.com/html5-qrcode"></script>

<style>
body{margin:0;font-family:Arial;background:#f2f2f2}
header{
background:linear-gradient(45deg,#7b1fa2,#512da8);
color:white;
padding:20px;
text-align:center;
font-size:22px;
}

.container{padding:10px}

.box{
color:white;
padding:20px;
border-radius:15px;
margin:8px 0;
font-size:18px;
}

.purple{background:linear-gradient(45deg,#8e24aa,#5e35b1)}
.blue{background:linear-gradient(45deg,#1e88e5,#1565c0)}
.green{background:linear-gradient(45deg,#43a047,#2e7d32)}
.orange{background:linear-gradient(45deg,#fb8c00,#ef6c00)}

.section{
background:white;
margin:10px 0;
padding:15px;
border-radius:15px;
}

.section h3{margin-top:0}

.red{color:red;font-weight:bold}
.yellow{color:#ff8f00;font-weight:bold}

.bottom-menu{
position:fixed;
bottom:0;
width:100%;
background:white;
display:flex;
justify-content:space-around;
padding:10px 0;
border-top:1px solid #ddd;
}

.bottom-menu div{
text-align:center;
font-size:14px;
}
</style>
</head>

<body>

<header>
ğŸ‘ Ã‡iftlik YÃ¶netimi<br>
<small>DedekÃ¶y Ã‡iftliÄŸi</small>
</header>

<div class="container" id="icerik">

<div class="box purple">
Toplam Hayvan<br>
<span id="toplam">0</span>
</div>

<div class="box blue">
ğŸ‘ Koyun: <span id="koyun">0</span>
</div>

<div class="box green">
ğŸ KoÃ§: <span id="koc">0</span>
</div>

<div class="box orange">
ğŸ‘ Kuzu: <span id="kuzu">0</span>
</div>

<div class="section">
<h3>ğŸ”» Kesime Uygun Hayvanlar</h3>
<div id="kesimListe"></div>
</div>

<div class="section">
<h3>ğŸ“… YaklaÅŸan AÅŸÄ±lar</h3>
<div id="asiListe"></div>
</div>

</div>

<div class="bottom-menu">
<div onclick="sayfaGoster('anasayfa')">ğŸ <br>Ana Sayfa</div>
<div onclick="sayfaGoster('tara')">ğŸ“·<br>Tara</div>
<div onclick="sayfaGoster('ekle')">â•<br>Ekle</div>
<div onclick="sayfaGoster('liste')">ğŸ“‹<br>Liste</div>
</div>

<script>

const API_URL = "https://script.google.com/macros/s/AKfycbwjE_8OBm_LmAGEgjl8S6uiyW4kknlW7N5X84Pt95D7WK-IF8Yelqn-UA73-qK0eFXI/exec";

async function dashboardYukle(){

const response = await fetch(API_URL,{
method:"POST",
body: JSON.stringify({tip:"dashboard"})
});

const data = await response.json();

document.getElementById("toplam").innerText = data.toplam;
document.getElementById("koyun").innerText = data.koyun;
document.getElementById("koc").innerText = data.koc;
document.getElementById("kuzu").innerText = data.kuzu;

let kesimHTML="";
data.kesim.forEach(h=>{
kesimHTML += `<div class="red">${h.qr} - ${h.sonKilo} kg</div>`;
});
document.getElementById("kesimListe").innerHTML = kesimHTML;

let asiHTML="";
data.asi.forEach(a=>{
asiHTML += `<div class="yellow">${a.qr} - ${a.tarih}</div>`;
});
document.getElementById("asiListe").innerHTML = asiHTML;

}

dashboardYukle();
function sayfaGoster(sayfa){

if(sayfa=="anasayfa"){
  dashboardYukle();
}

if(sayfa=="tara"){
  document.getElementById("icerik").innerHTML = `
  <div class="section">
  <h3>QR Tara</h3>
  <div id="reader"></div>
  </div>`;
}

if(sayfa=="ekle"){
  document.getElementById("icerik").innerHTML = `
  <div class="section">
  <h3>Yeni Hayvan</h3>
  QR:
  <input id="yeniQR">
  KÃ¼pe:
  <input id="yeniKupe">
  TÃ¼r:
  <select id="yeniTur">
    <option>Koyun</option>
    <option>Kuzu</option>
    <option>KoÃ§</option>
    <option>DÃ¼ve</option>
    <option>Dana</option>
    <option>Ä°nek</option>
    <option>BoÄŸa</option>
  </select>
  <button onclick="hayvanEkleManuel()">Kaydet</button>
  </div>`;
}

if(sayfa=="liste"){
  hayvanListesi();
}

}

async function hayvanEkleManuel(){

await fetch(API_URL,{
method:"POST",
body: JSON.stringify({
  tip:"hayvanEkle",
  qr: document.getElementById("yeniQR").value,
  kupe: document.getElementById("yeniKupe").value,
  tur: document.getElementById("yeniTur").value
})
});

alert("Kaydedildi");
dashboardYukle();
}

async function hayvanListesi(){

const response = await fetch(API_URL,{
method:"POST",
body: JSON.stringify({tip:"dashboard"})
});

const data = await response.json();

let html = `<div class="section"><h3>TÃ¼m Hayvanlar</h3>`;

data.kesim.forEach(h=>{
html += `<div style="color:red">${h.qr} - ${h.sonKilo} kg</div>`;
});

html += `</div>`;

document.getElementById("icerik").innerHTML = html;

}
</script>

</body>
</html>
