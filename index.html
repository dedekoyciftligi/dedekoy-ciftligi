<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dedek√∂y √áiftliƒüi</title>

<style>
body{margin:0;font-family:Arial;background:#f2f2f2}
header{
background:#4a148c;
color:white;
padding:20px;
text-align:center;
font-size:20px;
}

#icerik{padding:15px;margin-bottom:70px}

.card{
background:white;
padding:15px;
border-radius:15px;
margin-bottom:10px;
}

button{
width:100%;
padding:12px;
margin-top:10px;
background:#2e7d32;
color:white;
border:none;
border-radius:8px;
}

input,select{
width:100%;
padding:10px;
margin-top:5px;
}

.bottom-menu{
position:fixed;
bottom:0;
width:100%;
background:white;
display:flex;
justify-content:space-around;
padding:10px 0;
border-top:1px solid #ddd;
}

.bottom-menu div{
text-align:center;
font-size:14px;
}

.kesim{color:red;font-weight:bold}
.besi{color:green;font-weight:bold}
</style>
</head>

<body>

<header>üêë Dedek√∂y √áiftliƒüi</header>

<div id="icerik"></div>

<div class="bottom-menu">
<div onclick="anasayfa()">üè†<br>Ana</div>
<div onclick="ekle()">‚ûï<br>Ekle</div>
<div onclick="liste()">üìã<br>Liste</div>
</div>

<script>

const API_URL = "https://script.google.com/macros/s/AKfycbwjE_8OBm_LmAGEgjl8S6uiyW4kknlW7N5X84Pt95D7WK-IF8Yelqn-UA73-qK0eFXI/exec";

function anasayfa(){
document.getElementById("icerik").innerHTML = `
<div class="card">
<h3>Dashboard</h3>
<div id="toplam"></div>
<div id="kesim"></div>
</div>
`;
dashboard();
}

async function dashboard(){

const res = await fetch(API_URL,{
method:"POST",
body: JSON.stringify({tip:"dashboard"})
});

const data = await res.json();

document.getElementById("toplam").innerHTML =
"Toplam Hayvan: <b>"+data.toplam+"</b>";

let kesimHTML="<h4>Kesime Gidecekler</h4>";
data.kesim.forEach(h=>{
kesimHTML += "<div class='kesim'>"+h.qr+" - "+h.sonKilo+" kg</div>";
});
document.getElementById("kesim").innerHTML = kesimHTML;
}

function ekle(){
document.getElementById("icerik").innerHTML = `
<div class="card">
<h3>Yeni Hayvan</h3>
QR:<input id="qr">
K√ºpe:<input id="kupe">
T√ºr:
<select id="tur">
<option>Koyun</option>
<option>Kuzu</option>
<option>Ko√ß</option>
<option>D√ºve</option>
<option>Dana</option>
<option>ƒ∞nek</option>
<option>Boƒüa</option>
</select>
<button onclick="kaydet()">Kaydet</button>
</div>
`;
}

async function kaydet(){

await fetch(API_URL,{
method:"POST",
body: JSON.stringify({
tip:"hayvanEkle",
qr:document.getElementById("qr").value,
kupe:document.getElementById("kupe").value,
tur:document.getElementById("tur").value
})
});

alert("Kaydedildi");
anasayfa();
}

async function liste(){

const res = await fetch(API_URL,{
method:"POST",
body: JSON.stringify({tip:"dashboard"})
});

const data = await res.json();

let html="<div class='card'><h3>T√ºm Hayvanlar</h3>";

data.kesim.forEach(h=>{
html += "<div class='kesim'>"+h.qr+"</div>";
});

html+="</div>";

document.getElementById("icerik").innerHTML = html;
}

anasayfa();

</script>
<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js");
}
</script>
</body>
</html>
